"use client";

import useAgentChat from "./use-agent-chat";
import useCodeWorkspace from "./use-code-workspace";
import useDetails from "./use-details";
import useGallery from "./use-gallery";
import useIterationState from "./image-to-site/use-iteration-state";
import useNodeGraph from "./use-node-graph";
import usePreviewSettings from "./use-preview-settings";
import useViewMode from "./use-view-mode";

export default function useImageToSiteState() {
  const viewMode = useViewMode();
  const previewSettings = usePreviewSettings({
    setViewMode: viewMode.setViewMode,
  });
  const codeWorkspace = useCodeWorkspace();
  const agentChat = useAgentChat();
  const gallery = useGallery({
    onFilesIngested: codeWorkspace.actions.addCustomFiles,
  });
  const details = useDetails();
  const nodeGraph = useNodeGraph({ activeIndex: gallery.state.activeIndex });
  const iteration = useIterationState({
    isIterationMode: viewMode.isIterationMode,
    selectedPreviewIndex: previewSettings.state.selectedPreviewIndex,
  });

  return {
    state: {
      fileMeta: gallery.state.fileMeta,
      isDragging: gallery.state.isDragging,
      gallery: gallery.state.gallery,
      activeIndex: gallery.state.activeIndex,
      viewMode: viewMode.viewMode,
      previewCount: previewSettings.state.previewCount,
      selectedPreviewIndex: previewSettings.state.selectedPreviewIndex,
      speedValue: previewSettings.state.speedValue,
      title: details.state.title,
      name: details.state.name,
      details: details.state.details,
      customFiles: codeWorkspace.state.customFiles,
      activeCodeFileId: codeWorkspace.state.activeCodeFileId,
      openCodeTabs: codeWorkspace.state.openCodeTabs,
      codePanelMode: codeWorkspace.state.codePanelMode,
      collapsedFolders: codeWorkspace.state.collapsedFolders,
      codeContents: codeWorkspace.state.codeContents,
      agentInput: agentChat.state.agentInput,
      agentMessages: agentChat.state.agentMessages,
      iterationTool: iteration.state.iterationTool,
      showTransformControls: iteration.state.showTransformControls,
      showLayers: iteration.state.showLayers,
      showHistory: iteration.state.showHistory,
      showTextPanel: iteration.state.showTextPanel,
      showGrid: iteration.state.showGrid,
      snapToGrid: iteration.state.snapToGrid,
      showGuides: iteration.state.showGuides,
      snapToGuides: iteration.state.snapToGuides,
      gridSize: iteration.state.gridSize,
      guides: iteration.state.guides,
      isDrawing: iteration.state.isDrawing,
      draftCircle: iteration.state.draftCircle,
      pendingAnnotation: iteration.state.pendingAnnotation,
      noteDraft: iteration.state.noteDraft,
      annotations: iteration.state.annotations,
      iterationSize: iteration.state.iterationSize,
      siteBounds: iteration.state.siteBounds,
      selectedElementId: iteration.state.selectedElementId,
      selectedElementIds: iteration.state.selectedElementIds,
      elementTransforms: iteration.state.elementTransforms,
      scaleLock: iteration.state.scaleLock,
      zoomLevel: iteration.state.zoomLevel,
      panOffset: iteration.state.panOffset,
      isSpacePanning: iteration.state.isSpacePanning,
      isPanning: iteration.state.isPanning,
      textEdits: iteration.state.textEdits,
      textEditDraft: iteration.state.textEditDraft,
      layerState: iteration.state.layerState,
      layerFolders: iteration.state.layerFolders,
      layerFolderOrder: iteration.state.layerFolderOrder,
      deletedLayerIds: iteration.state.deletedLayerIds,
      highlightedIds: iteration.state.highlightedIds,
      baseLayout: iteration.state.baseLayout,
      showPatch: iteration.state.showPatch,
      pencilPoints: iteration.state.pencilPoints,
      isPencilDrawing: iteration.state.isPencilDrawing,
      selectedNodeId: nodeGraph.state.selectedNodeId,
      nodes: nodeGraph.state.nodes,
      edges: nodeGraph.state.edges,
    },
    derived: {
      hasFile: gallery.derived.hasFile,
      dropTitle: gallery.derived.dropTitle,
      dropMeta: gallery.derived.dropMeta,
      fileSizeLabel: gallery.derived.fileSizeLabel,
      activePreview: gallery.derived.activePreview,
      codeFileGroups: codeWorkspace.derived.codeFileGroups,
      codeTreeGroups: codeWorkspace.derived.codeTreeGroups,
      activeCodeFile: codeWorkspace.derived.activeCodeFile,
      activeCodeLanguage: codeWorkspace.derived.activeCodeLanguage,
      activeCodeContent: codeWorkspace.derived.activeCodeContent,
      isPreviewMode: viewMode.isPreviewMode,
      isIterationMode: viewMode.isIterationMode,
      selectedNodeLabel: nodeGraph.derived.selectedNodeLabel,
      qualityValue: previewSettings.derived.qualityValue,
      overlayMode: iteration.derived.overlayMode,
      isOverlayTool: iteration.derived.isOverlayTool,
      isTextTool: iteration.derived.isTextTool,
      isZoomTool: iteration.derived.isZoomTool,
      zoomLevel: iteration.derived.zoomLevel,
      panOffset: iteration.derived.panOffset,
      isPanMode: iteration.derived.isPanMode,
      isPanning: iteration.derived.isPanning,
      canTransform: iteration.derived.canTransform,
      canBoxSelect: iteration.derived.canBoxSelect,
      stageSize: iteration.derived.stageSize,
      notePosition: iteration.derived.notePosition,
      moveTargets: iteration.derived.moveTargets,
      nestedSelectionIds: iteration.derived.nestedSelectionIds,
      hasNestedSelection: iteration.derived.hasNestedSelection,
      primaryMoveTargetId: iteration.derived.primaryMoveTargetId,
      layerEntries: iteration.derived.layerEntries,
      layerFolderEntries: iteration.derived.layerFolderEntries,
      ungroupedLayerEntries: iteration.derived.ungroupedLayerEntries,
      iterationPatch: iteration.derived.iterationPatch,
      verticalGuides: iteration.derived.verticalGuides,
      horizontalGuides: iteration.derived.horizontalGuides,
      historyEntries: iteration.derived.historyEntries,
      activeHistoryId: iteration.derived.activeHistoryId,
      canUndo: iteration.derived.canUndo,
      canRedo: iteration.derived.canRedo,
    },
    refs: iteration.refs,
    actions: {
      setActiveIndex: gallery.actions.setActiveIndex,
      setPreviewCount: previewSettings.actions.setPreviewCount,
      setSpeedValue: previewSettings.actions.setSpeedValue,
      setTitle: details.actions.setTitle,
      setName: details.actions.setName,
      setDetails: details.actions.setDetails,
      setViewMode: viewMode.setViewMode,
      setSelectedPreviewIndex: previewSettings.actions.setSelectedPreviewIndex,
      setCodePanelMode: codeWorkspace.actions.setCodePanelMode,
      setAgentInput: agentChat.actions.setAgentInput,
      setIterationTool: iteration.actions.setIterationTool,
      setShowTransformControls: iteration.actions.setShowTransformControls,
      setShowLayers: iteration.actions.setShowLayers,
      setShowHistory: iteration.actions.setShowHistory,
      setShowTextPanel: iteration.actions.setShowTextPanel,
      setShowGrid: iteration.actions.setShowGrid,
      setSnapToGrid: iteration.actions.setSnapToGrid,
      setShowGuides: iteration.actions.setShowGuides,
      setSnapToGuides: iteration.actions.setSnapToGuides,
      setGridSize: iteration.actions.setGridSize,
      setShowPatch: iteration.actions.setShowPatch,
      setNoteDraft: iteration.actions.setNoteDraft,
      setSelectedElementId: iteration.actions.setSelectedElementId,
      setSelectedElementIds: iteration.actions.setSelectedElementIds,
      onNodesChange: nodeGraph.actions.onNodesChange,
      onEdgesChange: nodeGraph.actions.onEdgesChange,
      handleFileChange: gallery.actions.handleFileChange,
      handleDragOver: gallery.actions.handleDragOver,
      handleDragLeave: gallery.actions.handleDragLeave,
      handleDrop: gallery.actions.handleDrop,
      handlePrevImage: gallery.actions.handlePrevImage,
      handleNextImage: gallery.actions.handleNextImage,
      handleDeleteImage: gallery.actions.handleDeleteImage,
      handleSelectPreview: previewSettings.actions.handleSelectPreview,
      handleIteratePreview: previewSettings.actions.handleIteratePreview,
      handleNodeClick: nodeGraph.actions.handleNodeClick,
      handleOpenCodeFile: codeWorkspace.actions.handleOpenCodeFile,
      handleEditorChange: codeWorkspace.actions.handleEditorChange,
      handleToggleFolder: codeWorkspace.actions.handleToggleFolder,
      handleAgentSend: agentChat.actions.handleAgentSend,
      handleZoomPointer: iteration.actions.handleZoomPointer,
      handleZoomWheel: iteration.actions.handleZoomWheel,
      handlePanPointerDown: iteration.actions.handlePanPointerDown,
      handlePanPointerMove: iteration.actions.handlePanPointerMove,
      handlePanPointerEnd: iteration.actions.handlePanPointerEnd,
      handleCreateGuide: iteration.actions.handleCreateGuide,
      handleAddGuide: iteration.actions.handleAddGuide,
      handleUpdateGuide: iteration.actions.handleUpdateGuide,
      handleRemoveGuide: iteration.actions.handleRemoveGuide,
      handleClearGuides: iteration.actions.handleClearGuides,
      handleTextContentChange: iteration.actions.handleTextContentChange,
      handleTextStyleChange: iteration.actions.handleTextStyleChange,
      handleResetTextEdit: iteration.actions.handleResetTextEdit,
      applyTextStyles: iteration.actions.applyTextStyles,
      handleOverlayPointerDown: iteration.actions.handleOverlayPointerDown,
      handleOverlayPointerMove: iteration.actions.handleOverlayPointerMove,
      handleOverlayPointerEnd: iteration.actions.handleOverlayPointerEnd,
      handleSaveNote: iteration.actions.handleSaveNote,
      handleCancelNote: iteration.actions.handleCancelNote,
      handleSelectElement: iteration.actions.handleSelectElement,
      handleToggleHighlight: iteration.actions.handleToggleHighlight,
      updateElementTransform: iteration.actions.updateElementTransform,
      setScaleLock: iteration.actions.setScaleLock,
      toggleScaleLock: iteration.actions.toggleScaleLock,
      handleScaleStart: iteration.actions.handleScaleStart,
      handleScaleEnd: iteration.actions.handleScaleEnd,
      handleTransformStart: iteration.actions.handleTransformStart,
      handleTransformEnd: iteration.actions.handleTransformEnd,
      handleSelectoEnd: iteration.actions.handleSelectoEnd,
      handleDeleteSelection: iteration.actions.handleDeleteSelection,
      handleUndoHistory: iteration.actions.handleUndoHistory,
      handleRedoHistory: iteration.actions.handleRedoHistory,
      handleClearHistory: iteration.actions.handleClearHistory,
      handleToggleLayerVisibility: iteration.actions.handleToggleLayerVisibility,
      handleToggleLayerLock: iteration.actions.handleToggleLayerLock,
      handleCreateLayerFolder: iteration.actions.handleCreateLayerFolder,
      handleRenameLayerFolder: iteration.actions.handleRenameLayerFolder,
      handleRemoveLayerFolder: iteration.actions.handleRemoveLayerFolder,
      handleToggleLayerFolderCollapsed:
        iteration.actions.handleToggleLayerFolderCollapsed,
      handleAddSelectionToFolder: iteration.actions.handleAddSelectionToFolder,
      handleUnlinkSelection: iteration.actions.handleUnlinkSelection,
      handleToggleLayerFolderVisibility:
        iteration.actions.handleToggleLayerFolderVisibility,
      handleToggleLayerFolderLock: iteration.actions.handleToggleLayerFolderLock,
      getTransformState: iteration.actions.getTransformState,
      getTransformControlState: iteration.actions.getTransformControlState,
    },
  };
}
